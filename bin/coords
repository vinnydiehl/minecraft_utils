#!/usr/bin/ruby

require "optparse"

ARGV.push "-h" if ARGV.empty?

options = {}
location = "Nether"
OptionParser.new do |opts|
  opts.banner = "Usage: coords [options] X Z"

  opts.on("-o", "--overworld",
          "calculates nether -> overworld coordinates") do |o|
    options[:overworld] = o
    location = "Overworld"
  end
end.parse!

# Try and find 2 valid numbers in the args.
# They could run `coords 550 fuck you 700` for all I care.
case (coords = ARGV.grep(/^\d+$/).map &:to_i).size
when 3
  # If they give XYZ, strip the Y
  coords -= [coords[1]]
when 2
  # Perfect
else
  puts "No proper coordinate input found."
  exit 1
end

# Transform the coordinates
x, z = coords.map do |c|
  if options[:overworld]
    c * 8
  else
    (c / 8.0).round
  end
end

puts "#{location} Coordinates: #{x}, #{z}"
